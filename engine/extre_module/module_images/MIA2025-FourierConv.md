# Fourier Convolution Block (FCB) 模块总结

## 1. 背景

### 1.1 MRI重建中的感受野问题
- **MRI重建特殊性**：MRI采用k-space欠采样来缩短扫描时间，但会产生全局分布的混叠伪影，这与超分辨率等任务中的局部截断不同 [2]
- **CNN局限性**：传统CNN基于局部空间卷积（如3×3、5×5核），感受野有限，难以有效处理全局分布的混叠伪影 [2][3]
- **有效感受野问题**：虽然理论上深层网络可以通过堆叠卷积层覆盖大的感受野，但实际的有效感受野（ERF）远小于理论值 [3]

### 1.2 现有解决方案的不足
- **Vision Transformers**：通过多头自注意力机制实现全局建模，但计算开销大，训练困难 [3][4]
- **大核卷积**：直接增大卷积核尺寸（如31×31），但参数量和计算复杂度急剧增加 [4][5]
- **现有Fourier方法局限**：早期Fourier卷积因参数量过大，无法应用于现代深层CNN架构 [5]

## 2. 模块原理

### 2.1 核心数学原理
FCB基于**空间域卷积与频域逐点乘法的等价性**：

**空间域到频域变换**：
```
X(k₁, k₂) = Σ Σ x(n,m)/N² · exp[-2πj/N(nk₁ + mk₂)]  [6]
```

**频域操作**：
```
Y(k₁, k₂) = X(k₁, k₂) ⊙ W(k₁, k₂)  [6]
```

**等价关系**：
```
IDFT{Y} = x * w  [6]
```

其中卷积核w可以是任意大小（1×1到N×N），实现了**自适应感受野** [6]

### 2.2 FCB实现流程
1. **输入变换**：通过FFT将输入特征x变换到频域
2. **频域乘法**：与可学习的频域核W进行逐点复数乘法
3. **输出变换**：通过IFFT变换回空间域
4. **共轭对称性**：利用实数信号的共轭对称性，只存储和计算一半的频域数据 [7]

**完整公式**：
```
y = F⁻¹{F{x} ⊗ W}  [7]
```

### 2.3 关键技术改进

#### 2.3.1 Depth-wise卷积集成
- 将FCB与depth-wise卷积结合，大幅减少参数量
- 添加identity shortcut连接，提升训练稳定性 [8][9]

#### 2.3.2 Re-parameterization训练策略
- **两阶段训练**：
  1. 第一阶段：用传统3×3卷积训练，学习局部特征
  2. 第二阶段：将3×3卷积参数转换为FCB参数，微调学习全局特征 [9]

**参数转换公式**：
```
W(k₁, k₂) = 1/N² Σ Σ w(n,m) exp[-2πj/N(k₁n + k₂m)]  [9]
```

#### 2.3.3 循环填充
使用循环卷积确保FCB与局部卷积的严格等价性，符合MRI信号的自然环绕特性 [9]

## 3. 解决了什么问题

### 3.1 感受野扩展问题
- **全局感受野**：FCB能实现与输入图像大小相同的全局感受野，有效处理全局分布的混叠伪影 [6][7]
- **自适应性**：通过反向传播自适应学习最优感受野大小，无需人工设定 [7]

### 3.2 计算效率问题
**理论复杂度对比** [7]：
- 传统卷积：`S·f·f'·N²·K²`
- FCB：`S·f·N²·(f' + 4logN)`

当核尺寸K较大时，FCB显著更高效。实验显示FCB比21×21卷积快3倍以上 [17][19]

### 3.3 参数量控制问题
- 通过depth-wise卷积设计，将大部分参数集中在1×1卷积中
- 相比直接的大核卷积，参数增长更可控 [8]

### 3.4 训练稳定性问题
- **Re-parameterization策略**：先学局部后学全局，避免大感受野网络的训练困难
- **渐进式扩展**：从小核逐步扩展到全局核，保证训练收敛 [9]

### 3.5 通用性问题
- **即插即用**：可直接替换现有CNN中的卷积层，无需大幅修改架构
- **广泛适用**：在UNet、E2EVar、MoDL、VSNet等多种架构中均有效 [8][10]

### 3.6 实际效果验证
**性能提升** [11][12]：
- PSNR提升0.5-1.5 dB
- SSIM提升0.01-0.02
- 更好的细节恢复和伪影抑制

**可视化证据** [18][20]：
- 有效感受野显著扩大
- 频谱分布更接近真实k-space数据特征
- 与采样点扩散函数（PSF）分布更匹配

---

**总结**：FCB通过巧妙的频域设计，在保持计算效率的同时实现了全局感受野，为MRI重建中的全局伪影处理提供了一个优雅而实用的解决方案。