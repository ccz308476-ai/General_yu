# MaIR: 基于局部性和连续性保持的Mamba图像修复方法

## 核心思想和主要贡献

本文提出了MaIR（MaIR: A Locality- and Continuity-Preserving Mamba for Image Restoration），这是一种新颖的基于Mamba的图像修复模型，旨在解决现有Mamba方法在处理2D图像时破坏局部性和连续性的问题[1]。

**主要创新点：**
- 提出了嵌套S形扫描策略（NSS）来同时保持图像的局部性和连续性[1]
- 设计了序列混洗注意力模块（SSA）来聚合不同扫描方向的序列信息[1]
- 在四个图像修复任务的14个数据集上超越了40个基线方法，达到了最先进的性能[1]

## 技术方法详解

### 1. 问题分析
现有的Mamba图像修复方法存在两个主要缺陷[3]：
- 将2D图像展平为1D序列时破坏了图像固有的局部性和连续性
- 通过简单的像素级求和聚合处理后的序列，忽略了不同扫描方式产生的序列间的差异

### 2. 嵌套S形扫描策略（NSS）
NSS通过以下方式保持局部性和连续性[5][6]：
- **条纹式扫描区域**：将图像分割为多个非重叠条纹来保持局部性
- **S形扫描路径**：在条纹内部和条纹之间采用S形路径来维持连续性
- **移位条纹机制**：通过调整相邻模块的条纹宽度来确保边界区域的完整覆盖

### 3. 序列混洗注意力（SSA）
SSA模块通过以下步骤聚合不同序列[6][7]：
- 对处理后的序列进行空间平均池化并连接
- 执行序列混洗操作重新排列特征
- 使用分组卷积计算通道级注意力权重
- 通过加权求和生成最终输出

## 实验结果

### 1. 图像超分辨率
在经典超分辨率任务中，MaIR在几乎所有定量比较中都取得了最佳结果[8][9]：
- 在Urban100数据集上，MaIR比MambaIR提升了0.03dB~0.12dB（PSNR）
- 在轻量级超分辨率中，MaIR-Small在Manga109上比MambaIR-Small提升了0.08dB，同时使用更少的参数和计算量[10][11]

### 2. 图像去噪
在合成和真实噪声去除任务中表现优异[13][14]：
- 在Urban100数据集上，MaIR平均比MambaIR提升了0.21dB（PSNR）
- 在真实图像去噪中，MaIR达到了39.92dB的PSNR和0.960的SSIM

### 3. 图像去模糊
在运动去模糊任务中[15]：
- 在GoPro数据集上比Restormer提升了0.77dB
- 在HIDE数据集上比NAFNet提升了0.25dB

### 4. 图像去雾
在图像去雾任务中表现出色[16][17]：
- 在户外场景中，MaIR比DehazeFormer和UVM-Net分别提升了2.67dB和2.04dB
- 相比UVM-Net，MaIR仅使用0.3%的参数和4.8%的计算量

## 消融实验和分析

### 1. NSS有效性验证
通过替换不同扫描策略的对比实验证明了NSS的有效性[17]：
- 移除NSS或移位条纹机制都会导致性能下降
- 相比LocalMamba和ZigMa等方法，NSS能更好地保持局部性和连续性

### 2. SSA模块分析
对比不同聚合方法验证了SSA的优越性[17][18]：
- SSA比简单的序列相加、序列门控等方法都更有效
- 通过可视化比较展示了不同扫描策略对图像质量的影响[19]

### 3. 条纹宽度影响
实验表明方法对条纹宽度变化具有鲁棒性，在不同宽度设置下都能保持高质量的图像修复效果[19]。

## 总结

MaIR通过创新的NSS和SSA设计，成功解决了现有Mamba图像修复方法的局限性，在保持计算效率的同时显著提升了图像修复质量。该方法在多个图像修复任务上都达到了最先进的性能，证明了其在实际应用中的有效性和鲁棒性[19]。