# HS-FPN中HFP和SDP模块详细总结

---

## 一、高频感知模块（HFP）

### 1. 背景

传统微小目标检测方法常基于频域技术，因为微小目标通常表现为图像中的细节和边缘，对应频谱中的高频分量，而低频分量代表图像的整体轮廓和大面积平滑区域[3]。通过滤除低频分量可以突出微小目标，这可以用离散余弦变换（DCT）和高通滤波器实现。信号杂波比（SCR）实验表明，适度滤除低频分量能显著提高SCR值，使微小目标更加突出[3]。

### 2. 模块原理

HFP由三个核心组件构成[6][7]：

**高频特征生成器**：
- 使用预定义的高通滤波器提取输入特征Ci的高频响应Fi
- 滤波器z通过超参数α控制频带范围：当u < αH且v < αW时z(u,v)=0，否则为1[8]
- 当α=0时Fi等同于Ci；当α=1时阻断所有频率；α在0-1之间时滤除低频分量[8]

**通道路径（CP）**：
- 对高频响应Fi分别进行全局平均池化（GAP）和全局最大池化（GMP）
- 通过ReLU激活和1×1卷积生成通道注意力权重uCP
- 识别包含更多微小目标特征的通道并分配不同权重[7]

**空间路径（SP）**：
- 利用Fi作为空间掩码，通过1×1卷积聚合通道信息
- 生成空间注意力权重uSP，为每个像素分配权重
- 类似自注意力机制但基于高频响应而非相似性计算[7]

### 3. 解决的问题

- **特征稀疏问题**：微小目标特征在原始特征图中占比极小，HFP通过高频滤波增加微小目标特征在Fi中的比例[2][6]
- **注意力不足问题**：FPN对所有层采用相同处理方式，HFP为微小目标特征提供专门的通道和空间注意力[2][7]
- **背景干扰问题**：传统通道注意力易受低频同质背景影响，HFP基于高频响应计算更准确的注意力权重[6][21]

---

## 二、空间依赖感知模块（SDP）

### 1. 背景

FPN通过像素级逐点相加方式融合上下层特征，缺乏微小目标周围的空间感知能力。FPN中的递归上采样导致的像素偏移会造成上下层特征间的微小目标特征错位，严重影响检测精度[2][9]。Vision Transformer（ViT）中的注意力机制擅长捕获长程依赖关系，为解决空间感知问题提供了启发[9]。

### 2. 模块原理

SDP采用像素级跨注意力机制[9][10]：

**特征预处理**：
- 将上层特征Pi+1上采样至与Ci相同尺寸，得到Pui+1
- 通过三个1×1卷积分别计算Query（Q）、Key（K）、Value（V）矩阵
- Q来自Ci，K和V来自Pui+1[9]

**分块注意力计算**：
- 将{Q,K,V}划分为n个特征块，每块大小为H5×W5（C5的分辨率）
- 对每个特征块qj和kj计算相似性矩阵aj = Softmax(qj×kjT/√C)
- 用aj对对应的vj进行加权，生成富含空间依赖和高层语义的特征块[10]

**特征聚合**：
- 将处理后的特征块按空间位置聚合，形成新的空间依赖特征
- 与原始Ci相加，丰富微小目标的特征内容[10]

### 3. 解决的问题

- **空间感知缺失**：FPN缺乏空间感知能力，SDP通过像素级注意力捕获上下层特征间的空间依赖关系[2][9]
- **特征错位问题**：FPN上采样导致的像素偏移造成特征错位，SDP通过跨层注意力机制实现更准确的特征对齐[2][9]
- **语义信息不足**：SDP使下层特征Ci中的像素能与上层Pi+1中更广范围的像素交互，注入丰富的高层语义信息[10]

---

## 三、模块协同效果

HFP和SDP的结合产生协同正效应：HFP有效增强微小目标特征并抑制背景噪声，SDP进一步丰富空间依赖信息并抑制HFP可能放大的高频噪声。实验表明，两模块结合比单独使用效果更佳，在AI-TOD数据集上AP提升达3.4个百分点[12]。